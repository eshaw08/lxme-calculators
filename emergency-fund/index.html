<!-- ============ EMERGENCY FUND CALCULATOR FOR WORDPRESS ============ -->
<section id="emergency-calculator">
  <div class="emergency-card">
    <!-- LEFT SIDE -->
    <div class="emergency-left">
      <div class="header">
        <h2>Emergency Fund Calculator</h2>
        <a
          href="https://lxme.in/?source_caller=ui&shortlink=mymoneytab04&c=lxme-website&pid=mymoneytab-Emergency%20calc-%20website&deep_link_value=mymoneytab&af_xp=custom"
          class="btn-primary"
          target="_blank"
        >
          Invest Now
        </a>
      </div>

      <div class="tip-box">ðŸ’¡ Emergency Fund: Cushion for Life's Storms.</div>

      <!-- Monthly Expense -->
      <div class="field">
        <div class="label-row">
          <label>What is your monthly expense?</label>
          <div class="input-box">
            â‚¹
            <input
              type="number"
              id="expenseInput"
              value="50000"
              min="1000"
              max="1000000"
            />
          </div>
        </div>
        <input
          type="range"
          id="expenseRange"
          min="1000"
          max="1000000"
          step="1000"
          value="50000"
        />
        <div class="minmax">
          <span>â‚¹1,000</span>
          <span>â‚¹10,00,000</span>
        </div>
      </div>

      <!-- Months to Build Fund -->
      <div class="field">
        <div class="label-row">
          <label>
            How many months do you want to build an Emergency Fund for?
            <button class="info-btn" id="infoBtn" type="button">
              <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                <circle
                  cx="8"
                  cy="8"
                  r="7"
                  stroke="currentColor"
                  stroke-width="1.5"
                />
                <path
                  d="M8 7V11M8 5V5.5"
                  stroke="currentColor"
                  stroke-width="1.5"
                  stroke-linecap="round"
                />
              </svg>
            </button>
          </label>
          <div class="input-box">
            <input type="number" id="monthsInput" value="8" min="3" max="36" />
            Months
          </div>
        </div>
        <div class="info-message" id="infoMessage">
          Ideal Emergency Fund should be built for at least 6 months
        </div>
        <input type="range" id="monthsRange" min="3" max="36" value="8" />
        <div class="minmax">
          <span>3 Months</span>
          <span>36 Months</span>
        </div>
      </div>

      <!-- Time to Build -->
      <div class="field">
        <div class="label-row">
          <label>In how many months, do you want to build this fund?</label>
          <div class="input-box">
            <input type="number" id="timeInput" value="36" min="1" max="36" />
            Months
          </div>
        </div>
        <input type="range" id="timeRange" min="1" max="36" value="36" />
        <div class="minmax">
          <span>1 Month</span>
          <span>36 Months</span>
        </div>
      </div>

      <!-- Expected Return Rate -->
      <div class="field">
        <div class="label-row">
          <label>Expected rate of return</label>
          <div class="input-box">
            <input
              type="number"
              id="rateInput"
              value="6"
              min="2"
              max="8"
              step="0.1"
            />
            %
          </div>
        </div>
        <input
          type="range"
          id="rateRange"
          min="2"
          max="8"
          step="0.1"
          value="6"
        />
        <div class="minmax">
          <span>2%</span>
          <span>8%</span>
        </div>
      </div>
    </div>

    <!-- RIGHT SIDE -->
    <div class="emergency-right">
      <h4>Required Emergency Fund</h4>
      <h1>â‚¹ <span id="requiredFund">0</span></h1>

      <div class="chart-legend">
        <span><span class="dot blue"></span> Monthly Expenses</span>
        <span><span class="dot pink"></span> Required Emergency Fund</span>
      </div>

      <canvas id="emergencyChart"></canvas>

      <div class="investment-summary">
        <div>
          <span>Required Monthly SIP</span>
          <strong id="requiredSIP">â‚¹0</strong>
        </div>
        <div>
          <span>Required Lumpsum</span>
          <strong id="requiredLumpsum">â‚¹0</strong>
        </div>
      </div>

      <a
        href="https://lxme.in/?source_caller=ui&shortlink=mymoneytab04&c=lxme-website&pid=mymoneytab-Emergency%20calc-%20website&deep_link_value=mymoneytab&af_xp=custom"
        class="btn-primary big"
        target="_blank"
      >
        Invest Now
      </a>
    </div>
  </div>

  <!-- Growth Comparison Table -->
  <div class="growth-table">
    <h3>How your Emergency Fund grows if kept at:</h3>
    <table>
      <thead>
        <tr>
          <th>Storage Option</th>
          <th>Expected Returns</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Home (Locker, Cupboard, Purse, etc)</td>
          <td>0%</td>
        </tr>
        <tr>
          <td>Savings Account</td>
          <td>3%</td>
        </tr>
        <tr>
          <td>FD</td>
          <td>5.75%</td>
        </tr>
        <tr class="highlight">
          <td>LXME's Emergency Fund</td>
          <td>6.13%*</td>
        </tr>
      </tbody>
    </table>

    <div class="cta-section">
      <p>
        Explore LXME's Emergency Fund, a smart and tax-efficient way of parking
        your emergency savings!
      </p>
      <a
        href="https://lxme.in/emergency-fund"
        class="btn-primary"
        target="_blank"
        >Explore Now!</a
      >
    </div>

    <p class="disclaimer">
      *The above data is the Last 3 Year CAGR of LXME's Emergency Fund, as of
      1st July 2024.
    </p>
  </div>
</section>

<!-- ============ CSS ============ -->
<style>
  #emergency-calculator * {
    font-family:
      Inter,
      -apple-system,
      BlinkMacSystemFont,
      "Segoe UI",
      sans-serif;
    box-sizing: border-box;
  }

  #emergency-calculator {
    padding: 40px 20px;
    background: #f9f9f9;
  }

  .emergency-card {
    max-width: 1200px;
    margin: auto;
    background: #fff;
    border-radius: 24px;
    padding: 40px;
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 50px;
    border: 1px solid #e9e9e9;
    box-shadow: 0 2px 12px rgba(0, 0, 0, 0.03);
  }

  .header {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .header h2 {
    margin: 0;
    font-size: 28px;
    color: #333;
  }

  .btn-primary {
    background: #d63a8d;
    color: #fff;
    padding: 12px 28px;
    border-radius: 30px;
    border: none;
    font-weight: 600;
    cursor: pointer;
    text-decoration: none;
    display: inline-block;
    transition: background 0.2s ease;
  }

  .btn-primary:hover {
    background: #c02e7a;
  }

  .tip-box {
    background: #fff7e6;
    padding: 16px;
    border-radius: 12px;
    margin: 20px 0 30px;
    text-align: center;
  }

  .field {
    margin-bottom: 32px;
  }

  .field label {
    display: block;
    font-weight: 500;
    color: #333;
    margin-bottom: 8px;
    font-size: 14px;
  }

  .label-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
    gap: 12px;
  }

  .label-row label {
    margin: 0;
    flex: 1;
  }

  .input-box {
    background: #fff1f7;
    padding: 6px 14px;
    border-radius: 8px;
    color: #d63a8d;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 4px;
    white-space: nowrap;
  }

  .input-box input {
    width: 80px;
    border: none;
    background: transparent;
    text-align: right;
    font-weight: 600;
    outline: none;
    color: #d63a8d;
    font-size: 15px;
  }

  input[type="range"] {
    width: 100%;
    margin-top: 10px;
    accent-color: #d63a8d;
    cursor: pointer;
  }

  .minmax {
    display: flex;
    justify-content: space-between;
    font-size: 13px;
    margin-top: 6px;
    color: #666;
  }

  /* RIGHT SIDE */
  .emergency-left {
    position: relative;
    padding-right: 40px;
  }

  .emergency-left::after {
    content: "";
    position: absolute;
    top: 0;
    right: -25px;
    width: 1px;
    height: 100%;
    background: #e5e5e5;
  }

  .emergency-right {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
  }

  .emergency-right h4 {
    color: #666;
    margin: 0 0 4px 0;
    font-weight: 500;
    font-size: 16px;
  }

  .emergency-right h1 {
    font-size: 42px;
    margin: 0 0 20px 0;
    color: #000;
  }

  .chart-legend {
    display: flex;
    justify-content: center;
    gap: 20px;
    margin-bottom: 10px;
    font-size: 14px;
  }

  .dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    display: inline-block;
    margin-right: 6px;
  }

  .dot.blue {
    background: #f2c94c;
  }

  .dot.pink {
    background: #d63a8d;
  }

  canvas {
    width: 100% !important;
    max-height: 300px;
    margin-bottom: 20px;
  }

  .investment-summary {
    margin-top: 20px;
    display: grid;
    gap: 14px;
    width: 100%;
  }

  .investment-summary div {
    background: #f7f7f7;
    padding: 16px 22px;
    border-radius: 12px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .investment-summary span {
    color: #666;
    font-size: 14px;
  }

  .investment-summary strong {
    color: #d63a8d;
    font-size: 18px;
  }

  .big {
    margin-top: 30px;
    width: 220px;
  }

  /* INFO BUTTON */
  .info-btn {
    background: none;
    border: none;
    color: #d63a8d;
    cursor: pointer;
    padding: 0;
    margin-left: 6px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    transition: transform 0.2s;
  }

  .info-btn:hover {
    transform: scale(1.1);
    color: #c02e7a;
  }

  .info-message {
    background: #fff7e6;
    padding: 10px 14px;
    border-radius: 8px;
    margin-top: 10px;
    font-size: 13px;
    color: #f2b705;
    border: 1px solid #f2c94c;
    display: none;
  }

  .info-message.show {
    display: block;
  }

  /* GROWTH TABLE */
  .growth-table {
    max-width: 1200px;
    margin: 40px auto;
    padding: 30px;
    background: #fff;
    border-radius: 16px;
    border: 1px solid #e9e9e9;
  }

  .growth-table h3 {
    margin: 0 0 20px 0;
    font-size: 24px;
    color: #333;
  }

  .growth-table table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 30px;
  }

  .growth-table th,
  .growth-table td {
    padding: 14px 20px;
    text-align: left;
    border-bottom: 1px solid #e9e9e9;
  }

  .growth-table th {
    background: #f7f7f7;
    font-weight: 600;
    color: #333;
    font-size: 14px;
  }

  .growth-table td {
    font-size: 15px;
    color: #666;
  }

  .growth-table td:last-child {
    font-weight: 600;
    color: #333;
  }

  .growth-table tr.highlight {
    background: #fff1f7;
  }

  .growth-table tr.highlight td {
    color: #d63a8d;
    font-weight: 600;
  }

  .growth-table tbody tr:hover {
    background: #fafafa;
  }

  .growth-table tr.highlight:hover {
    background: #ffe6f0;
  }

  .cta-section {
    background: #f0f9ff;
    padding: 24px;
    border-radius: 12px;
    text-align: center;
    margin-bottom: 20px;
  }

  .cta-section p {
    margin: 0 0 16px 0;
    color: #333;
    font-size: 16px;
  }

  .disclaimer {
    font-size: 12px;
    color: #999;
    font-style: italic;
    margin: 16px 0 0 0;
  }

  /* MOBILE RESPONSIVE */
  @media (max-width: 768px) {
    #emergency-calculator {
      padding: 20px 12px;
    }

    .emergency-card {
      grid-template-columns: 1fr;
      padding: 24px 20px;
      gap: 30px;
    }

    .emergency-left::after {
      display: none;
    }

    .emergency-left {
      padding-right: 0;
    }

    .header {
      flex-direction: column;
      align-items: center;
      text-align: center;
      gap: 16px;
    }

    .header h2 {
      font-size: 22px;
    }

    .emergency-right h1 {
      font-size: 36px;
    }

    canvas {
      max-height: 250px !important;
    }

    .big {
      width: 100%;
      max-width: 300px;
    }

    .growth-table {
      margin: 30px 16px;
      padding: 24px 16px;
    }

    .growth-table h3 {
      font-size: 20px;
    }

    .growth-table th,
    .growth-table td {
      padding: 12px 14px;
      font-size: 14px;
    }

    .label-row {
      flex-direction: column;
      align-items: flex-start;
      gap: 8px;
    }

    .label-row label {
      width: 100%;
    }
  }

  @media (max-width: 480px) {
    .emergency-card {
      padding: 20px 16px;
    }

    .header h2 {
      font-size: 20px;
    }

    .emergency-right h1 {
      font-size: 32px;
    }

    .input-box input {
      width: 60px;
      font-size: 14px;
    }
  }
</style>

<!-- ============ JAVASCRIPT ============ -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
  (function () {
    // DOM elements
    const expenseInput = document.getElementById("expenseInput");
    const expenseRange = document.getElementById("expenseRange");
    const monthsInput = document.getElementById("monthsInput");
    const monthsRange = document.getElementById("monthsRange");
    const timeInput = document.getElementById("timeInput");
    const timeRange = document.getElementById("timeRange");
    const rateInput = document.getElementById("rateInput");
    const rateRange = document.getElementById("rateRange");
    const infoBtn = document.getElementById("infoBtn");
    const infoMessage = document.getElementById("infoMessage");

    // Output elements
    const requiredFundEl = document.getElementById("requiredFund");
    const requiredSIPEl = document.getElementById("requiredSIP");
    const requiredLumpsumEl = document.getElementById("requiredLumpsum");

    // Chart
    let chart = null;
    const chartCanvas = document.getElementById("emergencyChart");

    // Info button toggle
    infoBtn.addEventListener("click", function (e) {
      e.preventDefault();
      infoMessage.classList.toggle("show");
    });

    // Format currency
    function formatCurrency(num) {
      if (isNaN(num) || !isFinite(num)) return "â‚¹0";
      return "â‚¹" + Math.round(num).toLocaleString("en-IN");
    }

    // Calculate results
    function calculate() {
      const monthlyExpense = parseFloat(expenseInput.value);
      const monthsToBuild = parseFloat(monthsInput.value);
      const timePeriod = parseFloat(timeInput.value);
      const returnRate = parseFloat(rateInput.value) / 100;

      // Required Emergency Fund
      const requiredFund = monthlyExpense * monthsToBuild;

      // Monthly rate
      const monthlyRate = returnRate / 12;

      // SIP calculation
      const step1 = 1 + monthlyRate;
      const step2 = Math.pow(step1, timePeriod);
      const step3 = step2 - 1;
      const step4 = step3 / monthlyRate;
      const step5 = step4 * step1;
      const requiredSIP = requiredFund / step5;

      // Lumpsum calculation (using annual compounding)
      const years = timePeriod / 12;
      const requiredLumpsum = requiredFund / Math.pow(1 + returnRate, years);

      // Update DOM
      requiredFundEl.textContent =
        Math.round(requiredFund).toLocaleString("en-IN");
      requiredSIPEl.textContent = formatCurrency(requiredSIP);
      requiredLumpsumEl.textContent = formatCurrency(requiredLumpsum);

      // Update chart
      updateChart(monthlyExpense, requiredFund);
    }

    // Update chart with yellow and pink colors
    function updateChart(monthlyExpense, requiredFund) {
      if (chart) {
        chart.destroy();
      }

      chart = new Chart(chartCanvas, {
        type: "bar",
        data: {
          labels: ["Monthly Expenses", "Required Emergency Fund"],
          datasets: [
            {
              data: [monthlyExpense, requiredFund],
              backgroundColor: ["#f2c94c", "#d63a8d"],
              borderWidth: 0,
            },
          ],
        },
        options: {
          responsive: true,
          maintainAspectRatio: true,
          plugins: {
            legend: {
              display: false,
            },
            tooltip: {
              callbacks: {
                label: function (context) {
                  return (
                    "â‚¹" + Math.round(context.parsed.y).toLocaleString("en-IN")
                  );
                },
              },
            },
          },
          scales: {
            y: {
              beginAtZero: true,
              ticks: {
                callback: function (value) {
                  return "â‚¹" + value.toLocaleString("en-IN");
                },
              },
            },
          },
        },
      });
    }

    // Sync inputs with ranges
    expenseRange.addEventListener("input", function () {
      expenseInput.value = this.value;
      calculate();
    });

    expenseInput.addEventListener("input", function () {
      expenseRange.value = this.value;
      calculate();
    });

    monthsRange.addEventListener("input", function () {
      monthsInput.value = this.value;
      calculate();
    });

    monthsInput.addEventListener("input", function () {
      monthsRange.value = this.value;
      calculate();
    });

    timeRange.addEventListener("input", function () {
      timeInput.value = this.value;
      calculate();
    });

    timeInput.addEventListener("input", function () {
      timeRange.value = this.value;
      calculate();
    });

    rateRange.addEventListener("input", function () {
      rateInput.value = this.value;
      calculate();
    });

    rateInput.addEventListener("input", function () {
      rateRange.value = this.value;
      calculate();
    });

    // Initial calculation
    calculate();
  })();
</script>
